@page
@model MeuCrudCsharp.Pages.Profile.Admin.IndexModel
@{
    ViewData["Title"] = "Gerenciar Planos de Assinatura";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<link rel="stylesheet" href="~/css/admin/Profile/admin-profile.css" asp-append-version="true"/>

<div class="admin-layout">
    <partial name="partials/_AdminSideBar"/>

    <div class="admin-content-wrapper">
        <header class="mobile-header">
            <partial name="partials/_MobileHeader"/>
        </header>

        <main class="admin-main-content">
            <div class="admin-container">

                <div id="content-dashboard" class="content-panel active">
                    <h2>Dashboard</h2>
                    <p>Bem-vindo ao seu painel administrativo!</p>
                </div>

                <div id="content-courses" class="content-panel">
                    <partial name="partials/_AdminCourses"/>
                </div>

                <div id="content-plans" class="content-panel">
                    <partial name="partials/_AdminPlans"/>
                </div>

                <div id="content-students" class="content-panel">
                    <partial name="partials/_AdminStudents"/>
                </div>

                <div id="content-subscriptions" class="content-panel">
                    <partial name="partials/_AdminSubscriptions"/>
                </div>

                <div id="content-claims" class="content-panel">
                    <partial name="partials/_AdminClaims"/>
                </div>

            </div>
        </main>
    </div>
</div>

<div id="edit-course-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Editar Curso</h3>
            <span class="close-button" id="close-edit-course-modal">&times;</span>
        </div>
        <form id="edit-course-form">
            <input type="hidden" id="edit-course-id">
            <div class="form-group">
                <label for="edit-course-name">Nome do Curso</label>
                <input type="text" id="edit-course-name" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="edit-course-description">Descrição</label>
                <textarea id="edit-course-description" class="form-control" rows="4"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
        </form>
    </div>
</div>

<div id="edit-plan-modal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Editar Plano</h3>
            <span class="close-button" id="close-edit-plan-modal">&times;</span>
        </div>
        <form id="edit-plan-form">
            <input type="hidden" id="edit-plan-id">
            <div class="form-grid">
                <div class="form-group">
                    <label for="edit-plan-reason">Nome do Plano (Motivo)</label>
                    <input type="text" id="edit-plan-reason" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-plan-amount">Valor da Transação (R$)</label>
                    <input type="number" id="edit-plan-amount" class="form-control" step="0.01"
                           required>
                </div>
                <div class="form-group">
                    <label for="edit-plan-frequency">Frequência (Ex: 1, 3, 6, 12)</label>
                    <input type="number" id="edit-plan-frequency" class="form-control" required>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Salvar Alterações</button>
        </form>
    </div>
</div>

<div id="studentDetailsModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title">Detalhes do Aluno</h5>
            <!-- O botão de fechar agora usa a classe padrão "close-button" -->
            <button type="button" class="close-button" data-bs-dismiss="modal" aria-label="Close">
                &times;
            </button>
        </div>
        <!-- Renomeei para "modal-body-details" para ser mais específico -->
        <div class="modal-body-details mt-3">
            <p><strong>ID Público:</strong> <span id="modalStudentId"></span></p>
            <p><strong>ID da Assinatura:</strong> <span id="modalSubscriptionId"></span></p>
            <p><strong>Nome Completo:</strong> <span id="modalStudentName"></span></p>
            <p><strong>Email:</strong> <span id="modalStudentEmail"></span></p>
            <p><strong>Status da Assinatura:</strong> <span id="modalStudentStatus"></span></p>
            <p><strong>Plano Contratado:</strong> <span id="modalStudentPlan"></span></p>
            <p><strong>Data de Cadastro:</strong> <span id="modalStudentRegistrationDate"></span></p>
        </div>
    </div>
</div>

<div class="modal" id="changeClaimStatusModal" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Alterar Status da Reclamação</h5>
                <button type="button" class="btn-close" id="close-status-modal-btn"></button>
            </div>
            <div class="modal-body">
                <form id="change-status-form">
                    <input type="hidden" id="modal-claim-id">
                    <div class="mb-3">
                        <label for="modal-claim-status" class="form-label">Novo Status</label>
                        <select id="modal-claim-status" class="form-select">
                            <option value="Nova">Nova</option>
                            <option value="Em Análise">Em Análise</option>
                            <option value="Resolvida">Resolvida</option>
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancel-status-modal-btn">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Salvar Alterações</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="~/js/admin/Profile/admin-main.js" type="module" defer asp-append-version="true"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>