@page
@model MeuCrudCsharp.Pages.Profile.Admin.indexModel
@{
    ViewData["Title"] = "Gerenciar Planos de Assinatura";
}

<!-- 1. Dependência para os Ícones (Font Awesome) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<link rel="stylesheet" href="~/css/admin/Profile/index.css" asp-append-version="true" />
<!-- 3. Estrutura HTML com a Sidebar -->
<div class="admin-layout">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <div class="sidebar-header">Gerenciamento</div>
        <ul class="sidebar-nav">
            <li><a href="#" id="nav-plans" class="sidebar-link active"><i class="fas fa-tags"></i> Cadastrar Planos</a></li>
            <li><a href="#" id="nav-students" class="sidebar-link"><i class="fas fa-users"></i> Alunos</a></li>
            <li><a href="#" id="nav-subscriptions" class="sidebar-link"><i class="fas fa-cogs"></i> Gerenciar Assinaturas</a></li>
        </ul>
    </aside>

    <!-- Conteúdo Principal -->
    <main class="admin-main-content">
        <div class="admin-container">
            <!-- Painel "Criar Plano" -->
            <div id="content-plans" class="content-panel active">
                <h2>Criar Novo Plano de Assinatura</h2>
                <form id="create-plan-form" class="form-section">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="plan-reason">Nome do Plano (Motivo)</label>
                            <input type="text" id="plan-reason" class="form-control" placeholder="Ex: Acesso Mensal Premium" required>
                        </div>
                        <div class="form-group">
                            <label for="plan-type">Tipo de Plano</label>
                            <select id="plan-type" class="form-select">
                                <option value="months" selected>Mensal</option>
                                <option value="years">Anual</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="plan-amount">Valor (R$)</label>
                            <input type="number" id="plan-amount" class="form-control" step="0.01" placeholder="Ex: 49.90" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Criar Plano</button>
                </form>
            </div>

            <!-- Painel "Alunos" -->
            <div id="content-students" class="content-panel">
                <h2>Lista de Alunos</h2>
                <table class="table">
                    <thead>
                        <tr><th>Nome</th><th>Email</th><th>Status Assinatura</th><th>Data de Cadastro</th></tr>
                    </thead>
                    <tbody id="students-table-body">
                        <tr><td colspan="4" style="text-align: center;">Carregando alunos...</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Painel "Gerenciar Assinaturas" -->
            <div id="content-subscriptions" class="content-panel">
                <h2>Gerenciar Assinaturas</h2>
                <div class="form-group">
                    <label for="subscription-action-selector">Selecione uma Ação</label>
                    <select id="subscription-action-selector" class="form-select">
                        <option value="">-- Escolha uma operação --</option>
                        <option value="search">Buscar Assinatura</option>
                        <option value="update-value">Alterar Valor</option>
                        <option value="pause-cancel">Pausar ou Cancelar</option>
                        <option value="reactivate">Reativar Assinatura</option>
                    </select>
                </div>
                <div id="subscription-actions-container">
                    <form id="form-search" class="action-form">
                        <div class="form-group">
                            <label for="search-id">Buscar por ID da Assinatura ou Email do Aluno</label>
                            <div class="input-group">
                                <input type="text" id="search-id" class="form-control" placeholder="ID ou email..." required>
                                <button type="submit" class="btn btn-primary">Buscar</button>
                            </div>
                        </div>
                    </form>
                    <form id="form-update-value" class="action-form">
                        <div class="form-group"><label for="update-value-id">ID da Assinatura</label><input type="text" id="update-value-id" class="form-control" required></div>
                        <div class="form-group"><label for="update-value-amount">Novo Valor (R$)</label><input type="number" id="update-value-amount" class="form-control" step="0.01" required></div>
                        <button type="submit" class="btn btn-warning">Alterar Valor</button>
                    </form>
                    <form id="form-pause-cancel" class="action-form">
                        <div class="form-group"><label for="pause-cancel-id">ID da Assinatura</label><input type="text" id="pause-cancel-id" class="form-control" required></div>
                        <button type="submit" name="status" value="paused" class="btn btn-secondary">Pausar</button>
                        <button type="submit" name="status" value="cancelled" class="btn btn-danger">Cancelar</button>
                    </form>
                    <form id="form-reactivate" class="action-form">
                        <div class="form-group"><label for="reactivate-id">ID da Assinatura (deve estar pausada)</label><input type="text" id="reactivate-id" class="form-control" required></div>
                        <button type="submit" class="btn btn-success">Reativar Assinatura</button>
                    </form>
                </div>
                <div id="action-results" style="margin-top: 1.5rem;"></div>
            </div>
        </div>
    </main>
</div>

<!-- 4. JavaScript para interagir com a API -->
<script src="~/js/admin/Profile/index.js" asp-append-version="true"></script>
